<h1>Tweet Detail</h1>
<%= @tweet.body %>
<%= @tweet.user.name %>
<span>@<%= @tweet.user.username %></span>
<% if current_user %>
  <%= form_with model: [@reply] do |form| %>
    <%= form.hidden_field :replied_to_id, value: @reply.replied_to_id%>
    <%= form.text_area :body, class: "tweet_input", placeholder: "Tweet your reply" %>
    <%= form.submit value: "Tweet", class: "btn" %>
  <% end %>
<% end %>
<ul>
  <% @tweet.replies.each do |reply| %>
    <li class="">
      <%= link_to tweet_path(reply) do %>
        <%= reply.body %>
      <% end %>
        <%= reply.user.name %>
        <span>@<%= reply.user.username %></span>
        <span><%= reply.replies.size %></span>
        <% if current_user %>  
          <div class=''>
            <span><%= link_to edit_tweet_path(reply) do%><%= image_tag('update.png') %><% end %></span>
            <span><%= link_to tweet_path(reply), method: :delete, data: { confirm: "Are you sure you want to delete this tweet?" } do %> <%= image_tag('delete.png')%><% end %> </span>
          </div>
        <% end %>
        <% if current_user %>
          <% pre_like = reply.likes.find { |like| like.user_id == current_user.id} %>
        <% end %>
        <% if pre_like %>
          <%= button_to tweet_like_path(reply, pre_like), method: :delete do %>
            <%= image_tag 'like.svg' %>
          <% end %>
        <% else %>
          <%= button_to tweet_likes_path(reply), method: :post do %>
            <%= image_tag 'like.svg' %>
          <% end %>
        <% end %>
        <p><%= reply.likes.count %> </p>
    </li>
  <% end %>
</ul>